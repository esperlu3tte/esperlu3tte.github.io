<!DOCTYPE html>
<html lang="fr" class="h-100"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<meta name="color-scheme" content="light dark">
		<meta name="description" content="Le NFO Builder pourr album de musiques. Générateur de NFO basé sur MediaInfo, vous permettant de créer vos fichiers NFO spécialement pour les albums audios.">
		<base href="https://yggland.fr/" />

		<link rel="shortcut icon" href="/assets/img/yggland.png" type="image/x-icon">
		<link rel="stylesheet" href="/assets/css/bootstrap-dark.min.css" id="theme-css">
		<link rel="stylesheet" href="/assets/css/wbbtheme.css">
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/css/bootstrap-select.min.css">
		<link rel="preconnect" href="https://fonts.gstatic.com">
		<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@300;400&display=swap">
		<link rel="stylesheet" href="/assets/css/styles.css?v=60">

		<title>Générateur de NFO | NFO Builder</title>
	</head>

	<body class="d-flex flex-column h-100 fervex-dark">

		<!-- config -->
		<div class="modal fade" id="modalConfig" tabindex="-1" role="dialog" aria-labelledby="modalConfigLabel" aria-hidden="true">
			<div class="modal-dialog modal-dialog-slideout modal-sm" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title" id="modalConfigLabel">Choix du thème</h5>
						<button type="button" class="close" data-dismiss="modal" aria-label="Close">
							<span aria-hidden="true">×</span>
						</button>
					</div>
					<div class="modal-body">
						<form id="formThemeModal">
							<div class="custom-control custom-radio custom-control-inline">
								<input type="radio" id="themeSwitchLightModal" name="themeSwitchModal" class="custom-control-input" value="light">
								<label class="custom-control-label" for="themeSwitchLightModal">Light</label>
							</div>
							<div class="custom-control custom-radio custom-control-inline">
								<input type="radio" id="themeSwitchDarkModal" name="themeSwitchModal" class="custom-control-input" value="dark" checked="checked">
								<label class="custom-control-label" for="themeSwitchDarkModal">Dark</label>
							</div>
							<div class="custom-control custom-radio custom-control-inline">
								<input type="radio" id="themeSwitchNightfallModal" name="themeSwitchModal" class="custom-control-input" value="nightfall">
								<label class="custom-control-label" for="themeSwitchNightfallModal">Nightfall</label>
							</div>
						</form>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-secondary" data-dismiss="modal">Fermer</button>
					</div>
				</div>
			</div>
		</div>


		<header>
			<nav class="navbar navbar-expand-lg navbar-dark fixed-top bg-dark">
				<a class="navbar-brand" href="https://yggland.fr/"><img src="/assets/img/yggland-30.png" class="d-inline-block align-top" width="30" height="30" alt="Logo YGGLand"> YGGLand</a>
				<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				<div class="collapse navbar-collapse" id="navbarCollapse">
					<ul class="navbar-nav mx-auto">
						<li class="nav-item dropdown">
							<a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-expanded="false"><i class="fa fa-pencil-square-o"></i> FervexPrez</a>
							<div class="dropdown-menu">
								<a class="dropdown-item" href="https://yggland.fr/fervexprez/"><i class="fa fa-fw fa-pencil-square-o text-info"></i> FervexPrez</a>
								<div class="dropdown-divider"></div>
								<a class="dropdown-item" href="https://yggland.fr/fervexprez/mes-prezs.php"><i class="fa fa-fw fa-user text-info"></i> Mes prezs</a>
							</div>
						</li>
						<li class="nav-item dropdown active">
							<a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-expanded="false"><i class="fa fa-file-text-o"></i> NFO</a>
							<div class="dropdown-menu">
								<a class="dropdown-item" href="https://yggland.fr/nfo/"><i class="fa fa-fw fa-film text-info"></i> NFO Builder</a>
								<a class="dropdown-item active" href="https://yggland.fr/nfo/album-audio.php"><i class="fa fa-fw fa-music text-info"></i> Album NFO Builder</a>
								<div class="dropdown-divider"></div>
								<a class="dropdown-item" href="https://yggland.fr/nfo/mes-nfo.php"><i class="fa fa-fw fa-user text-info"></i> Mes NFO</a>
							</div>
						</li>
						<li class="nav-item dropdown">
							<a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-expanded="false"><i class="fa fa-gavel"></i> Outils</a>
							<div class="dropdown-menu">
								<a class="dropdown-item" href="https://yggland.fr/FAQ-Tutos/"><i class="fa fa-fw fa-question-circle text-info"></i> FAQ &amp; Tutos</a>
								<a class="dropdown-item" href="https://yggland.fr/FAQ-Tutos/glossaire.php"><i class="fa fa-fw fa-info-circle text-info"></i> Glossaire</a>
								<a class="dropdown-item" href="https://yggland.fr/FAQ-Tutos/definition-et-resolution-video.php"><i class="fa fa-fw fa-info-circle text-info"></i> Définition et résolution vidéo</a>
								<a class="dropdown-item" href="https://yggland.fr/FAQ-Tutos/qbittorrent-et-vpn.php"><i class="fa fa-fw fa-info-circle text-info"></i> Utiliser qBittorrent avec un VPN</a>
								<div class="dropdown-divider"></div>
								<a class="dropdown-item" href="https://yggland.fr/FAQ-Tutos/test-torrent-tracker-ygg.php"><i class="fa fa-fw fa-stethoscope text-success"></i> Test Tracker/Torrent</a>
								<a class="dropdown-item" href="https://yggland.fr/detection/"><i class="fa fa-fw fa-bug text-warning"></i> Debug IP/DNS</a>
								<a class="dropdown-item heartbeat" href="https://yggland.fr/FAQ-Tutos/#status"><i class="fa fa-fw fa-heartbeat text-danger"></i> Statut YGG</a>
							</div>
						</li>
						<li class="nav-item">
							<a class="nav-link" data-toggle="modal" data-target="#modalConfig" data-tooltip="tooltip" data-placement="bottom" title="" href="#" data-original-title="Changer le thème d'YGGLand">
								<i class="fa fa-cogs"></i>
								<span class="sr-only">Changer le thème</span>
							</a>
						</li>
					</ul>
					<form class="form-inline my-2 m-md-0" action="https://www.ygg.re/engine/search?do=search" method="get" target="_blank">
						<div class="input-group">
							<input type="text" name="name" id="searchtorrent" class="form-control" placeholder="Recherche YGG" aria-label="Recherche YGG" aria-describedby="button-search" required="">
							<input type="hidden" name="do" value="search">
							<div class="input-group-append">
								<button class="btn btn-secondary" type="submit" id="button-search" aria-label="Search"><i class="fa fa-search"></i><span class="sr-only">Recherche</span></button>
							</div>
						</div>
					</form>
				</div>
			</nav>
		</header>

		<div class="container my-auto h-100 pt-4">
			<section class="d-flex flex-column h-100 p-3">
					<div class="mb-4">
						<h3><i class="fa fa-cogs"></i> Album NFO Builder <small class="text-muted">Générateur de NFO pour album audio</small></h3>
						<hr>
					</div>
					<form class="form-row">
						<div class="col-sm-12 d-flex flex-wrap justify-content-between">
							<div class="custom-file d-inline-block nfo-input mb-4">
								<div class="custom-file nfo-input mb-4">
									  <input type="file" class="custom-file-input" id="fileinput" name="fileinput" multiple="">
									  <label class="custom-file-label" for="nfoinput" data-browse="Parcourir...">Choisir les pistes de l'album</label>
								</div>
							</div>
							<div>
								<button type="button" class="btn btn-secondary d-inline-block mb-4" id="save-nfo">Sauvegarder NFO</button>
								<button type="submit" class="btn btn-secondary d-inline-block mb-4" id="download-nfo">Télécharger NFO</button>
							</div>
						</div>
					</form>
					<textarea class="form-control h-100 mb-4 drop-zone" id="output">Ou déposez directement les pistes de l'album ici</textarea>
			</section>
		</div>


		<footer class="footer mt-auto py-3 footer-dark bg-dark">
			<div class="container d-flex flex-column flex-md-row justify-content-between align-items-center">
				<span>
					<img src="/assets/img/yggland-30.png" class="mr-2 pb-0" width="30" height="30" alt="Logo YGGLand">
					<a href="https://yggland.fr/">YGGLand</a> @2020-2024				</span>
				<form id="theme" class="my-2">
					<div class="custom-control custom-radio custom-control-inline">
						<input type="radio" id="themeSwitchLight" name="themeSwitch" class="custom-control-input" value="light">
						<label class="custom-control-label" for="themeSwitchLight">Light</label>
					</div>
					<div class="custom-control custom-radio custom-control-inline">
						<input type="radio" id="themeSwitchDark" name="themeSwitch" class="custom-control-input" value="dark" checked="checked">
						<label class="custom-control-label" for="themeSwitchDark">Dark</label>
					</div>
					<div class="custom-control custom-radio custom-control-inline">
						<input type="radio" id="themeSwitchNightfall" name="themeSwitch" class="custom-control-input" value="nightfall">
						<label class="custom-control-label" for="themeSwitchNightfall">Nightfall</label>
					</div>
				</form>
			</div>
		</footer>

		<button class="btn btn-sm btn-danger elevator" id="ascenseur" style="display: none;">
			<i class="fa fa-long-arrow-up"></i> Ascenseur <i class="fa fa-long-arrow-up"></i>
		</button>

		<script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-Piv4xVNRyMGpqkS2by6br4gNJ7DXjqk09RmUpJ8jgGtD7zP9yug3goQfGII0yAns" crossorigin="anonymous"></script>
		<script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/js/bootstrap-select.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/js-cookie@2.2.1/src/js.cookie.min.js"></script>
		<script src="/assets/js/jquery.wysibb.min.js"></script>
		<script src="/assets/js/fr.js"></script>

		<script src="/assets/js/scripts.js?v=56"></script>
		<script src="https://unpkg.com/mediainfo.js@0.3.3/dist/umd/index.min.js"></script>

		<script>
			$(document).ready(function () {
				const fileinput = document.getElementById('fileinput');
				const dropZone = document.getElementById('output');
				const output = document.getElementById('output');
				let tracklist = [];
				let originalFileName;

				const onChangeFile = (mediainfo, inputFiles) => {
					const files = Array.from(inputFiles);
					if (files.length > 0) {
						output.value = 'Lecture des fichiers…';
						tracklist = []; // Réinitialise le tableau tracklist pour chaque sélection de fichiers

						const processNextFile = (fileIndex) => {
							if (fileIndex >= files.length) {
								// Tous les fichiers ont été traités, génération du NFO complet
								const musicNFO = generateMusicNFO(files);
								output.value = musicNFO;
								return;
							}

							const file = files[fileIndex];
							const getSize = () => file.size;

							const readChunk = (chunkSize, offset) =>
								new Promise((resolve, reject) => {
									const reader = new FileReader();
									reader.onload = event => {
										if (event.target.error) {
											reject(event.target.error);
										}
										resolve(new Uint8Array(event.target.result));
									};
									reader.readAsArrayBuffer(file.slice(offset, offset + chunkSize));
								});

							mediainfo
								.analyzeData(getSize, readChunk)
								.then(result => {
									parseNFO(result);
									processNextFile(fileIndex + 1); // Passer au fichier suivant
								})
								.catch(error => {
									output.value = "Une erreur est apparue.\n ⚠ Attention de bien envoyer les pistes d'un album et non pas le dossier lui-même.\n\nDump de l'erreur :\n" + error.stack;
									console.error(error);
								});
						};

						processNextFile(0); // Commencer le traitement avec le premier fichier
					}
				};

				MediaInfo.mediaInfoFactory({
					format: 'text',
				}).then((mediainfo) => {
					fileinput.removeAttribute('disabled');
					fileinput.addEventListener('change', () => {
						onChangeFile(mediainfo, fileinput.files);
					});

					// Drag and drop functionality
					dropZone.addEventListener('dragover', (e) => {
						e.preventDefault();
						dropZone.classList.add('drag-over');
					});
					dropZone.addEventListener('dragleave', () => {
						dropZone.classList.remove('drag-over');
					});
					dropZone.addEventListener('drop', (e) => {
						e.preventDefault();
						dropZone.classList.remove('drag-over');
						onChangeFile(mediainfo, e.dataTransfer.files);
					});
				});

				const parseNFO = result => {
					const lines = result.split('\n');
					let trackInfo = {};
					lines.forEach(line => {
						const [key, value] = line.split(':').map(part => part.trim());
						if (key && value) {
							trackInfo[key] = value;
							// console.log(key+':'+value);
						}
					});
					tracklist.push(trackInfo);
				};

				const generateMusicNFO = (inputFiles) => {
					const marge = 35;
					let musicNFO = '';
					let cumulTime = 0;
					let cumulSize = 0;
					let codec = '';

					tracklist.forEach((trackInfo, index) => {
						if (index == 0) {
							let Album = trackInfo['Album'] || "Album inconnu";
							let AlbumPerformer = trackInfo['Album/Performer'] || trackInfo['Composer'] || trackInfo['Performer'] || "Artiste inconnu";
							codec = inputFiles[index].name.split('.').pop().toUpperCase();
							const truncatedAlbumPerformer = (AlbumPerformer.length > 81) ? AlbumPerformer.substring(0, 80) + '…' : AlbumPerformer;
							const truncatedAlbum = (Album.length > 81) ? Album.substring(0, 80) + '…' : Album;
							originalFileName = truncatedAlbumPerformer + ' - ' + truncatedAlbum;

							if (AlbumPerformer.length + Album.length > 78) {
								musicNFO += '---------------------------------------------------------------------------------\n';
								musicNFO += ' '.repeat(Math.floor((81 - truncatedAlbumPerformer.length) / 2)) + truncatedAlbumPerformer + '\n';
								musicNFO += ' '.repeat(Math.floor((81 - truncatedAlbum.length) / 2)) + truncatedAlbum + '\n';
								musicNFO += '---------------------------------------------------------------------------------\n';
							} else {
								musicNFO += '---------------------------------------------------------------------------------\n';
								musicNFO += ' '.repeat(Math.floor((78 - AlbumPerformer.length - Album.length) / 2)) + AlbumPerformer + ' - ' + Album + '\n';
								musicNFO += '---------------------------------------------------------------------------------\n';
							}
							musicNFO += '\n';
							musicNFO += 'Artiste'.padEnd(marge, '.') + ': ' + AlbumPerformer + '\n';
							musicNFO += 'Album'.padEnd(marge, '.') + ': ' + Album + '\n';
							musicNFO += 'Genre(s)'.padEnd(marge, '.') + ': ' + trackInfo['Genre'] + '\n';
							musicNFO += 'Year'.padEnd(marge, '.') + ': ' + trackInfo['Recorded date'] + '\n';
							musicNFO += '\n';
							musicNFO += 'Codec'.padEnd(marge, '.') + ': ' + codec + '\n';
							musicNFO += 'Format'.padEnd(marge, '.') + ': ' + [trackInfo['Format'], trackInfo['Format version'], trackInfo['Format profile']].filter(Boolean).join(' / ') + '\n';
							if (trackInfo['Format/Info']) musicNFO += 'Format/Info'.padEnd(marge, '.') + ': ' + trackInfo['Format/Info'] + '\n';
							if (codec == 'MP3') musicNFO += 'Overall bit rate'.padEnd(marge, '.') + ': ' + trackInfo['Overall bit rate'] + '\n';
							musicNFO += 'Bit rate mode'.padEnd(marge, '.') + ': ' + trackInfo['Bit rate mode'] + '\n';
							musicNFO += 'Channel'.padEnd(marge, '.') + ': ' + [trackInfo['Channel(s)'], trackInfo['Sampling rate'], trackInfo['Bit depth']].filter(Boolean).join(' / ') + '\n';
							musicNFO += 'Quality'.padEnd(marge, '.') + ': ' + trackInfo['Compression mode'] + '\n';
							musicNFO += 'Writing library'.padEnd(marge, '.') + ': ' + trackInfo['Writing library'] + '\n';
							musicNFO += 'Encoding settings'.padEnd(marge, '.') + ': ' + trackInfo['Encoding settings'] + '\n';
							musicNFO += '\n';
							musicNFO += '\n';
							musicNFO += '---------------------------------------------------------------------------------\n';
							musicNFO += '                                    Tracklist\n';
							musicNFO += '---------------------------------------------------------------------------------\n';
							musicNFO += '\n';
						}

						const trackNumber = index + 1;
						const trackArtiste = trackInfo['Performer'] || trackInfo['Album/Performer'] || '';
						const trackName = trackInfo['Track name'] || inputFiles[index].name || '';
						const trackDuration = convertToMMSS(trackInfo['Duration']) || '';

						cumulTime += convertToSec(trackInfo['Duration']);
						cumulSize += convertToKiB(trackInfo['File size']);

						musicNFO += trackNumber.toString().padStart(2, '0') + '. ';

						if (codec == 'MP3') {
							const trackTitle = (trackArtiste + ' - ' + trackName);
							const truncatedTrackTitle = trackTitle.length > 57 ? trackTitle.substring(0, 57 - 1) + '…' : trackTitle;
							musicNFO += truncatedTrackTitle.padEnd(57)
						} else {
							const trackTitle = (trackArtiste + ' - ' + trackName);
							const truncatedTrackTitle = trackTitle.length > 47 ? trackTitle.substring(0, 47 - 1) + '…' : trackTitle;
							musicNFO += truncatedTrackTitle.padEnd(47);
							musicNFO += (' [' + trackInfo['Overall bit rate'] + ']').padEnd(10);
						}

						musicNFO += (' [' + trackInfo['File size'] + ']').padEnd(12);
						musicNFO += '[' + trackDuration + ']\n';

						if (index === tracklist.length - 1) {
							const currentDate = new Date();
							const dateHeure = currentDate.toLocaleString('fr-FR', {day: '2-digit',month: '2-digit',year: 'numeric',hour: '2-digit',minute: '2-digit',second: '2-digit'});
							musicNFO += '\n';
							musicNFO += '\n';
							musicNFO += 'Playing Time'.padEnd(marge, '.') + ': ' + convertToTime(cumulTime) + '\n';
							musicNFO += 'Total Size'.padEnd(marge, '.') + ': ' + convertFileSize(cumulSize) + '\n';
							musicNFO += '\n';
							musicNFO += '\n';
							musicNFO += '---------------------------------------------------------------------------------\n';
							musicNFO += '█▄█ █▀▀ █▀▀ █   ▄▀█ █▄ █ █▀▄                     Generated on ' + dateHeure + '\n';
							musicNFO += ' █  █▄█ █▄█ █▄▄ █▀█ █ ▀█ █▄▀                     Generated by YGGLand NFO Builder\n';
							musicNFO += '---------------------------------------------------------------------------------\n';
						}
					});

					return musicNFO;
				};

				function convertToMMSS(duration) {
					const regex = /(?:(\d+) h)?(?:\s*(\d+) min)?(?:\s*(\d+) s)?/;
					const matches = duration.match(regex);
					if (matches) {
						const hours = parseInt(matches[1]) || 0;
						const minutes = parseInt(matches[2]) || 0;
						const seconds = parseInt(matches[3]) || 0;
						const totalMinutes = hours * 60 + minutes;
						const formattedMinutes = totalMinutes.toString().padStart(2, '0');
						const formattedSeconds = seconds.toString().padStart(2, '0');
						return `${formattedMinutes}:${formattedSeconds}`;
					}
					return null;
				}

				function convertToSec(duration) {
					const regex = /(?:(\d+) h)?(?:\s*(\d+) min)?(?:\s*(\d+) s)?(?:\s*(\d+) ms)?/;
					const matches = duration.match(regex);
					if (matches) {
						const hours = parseInt(matches[1]) || 0;
						const minutes = parseInt(matches[2]) || 0;
						const seconds = parseInt(matches[3]) || 0;
						const milliseconds = parseInt(matches[4]) || 0;
						const totalSeconds = hours * 3600 + minutes * 60 + seconds + milliseconds / 1000;
						return totalSeconds;
					}
					return null;
				}

				function convertToTime(seconds) {
					const hours = Math.floor(seconds / 3600);
					const minutes = Math.floor((seconds % 3600) / 60);
					const remainingSeconds = Math.floor(seconds % 60);

					const formattedHours = String(hours).padStart(2, '0');
					const formattedMinutes = String(minutes).padStart(2, '0');
					const formattedSeconds = String(remainingSeconds).padStart(2, '0');
					if (hours > 0) {
						return `${formattedHours}:${formattedMinutes}:${formattedSeconds}`;
					} else {
						return `${formattedMinutes}:${formattedSeconds}`;
					}
				}

				function convertToKiB(fileSize) {
					const units = {
						KiB: 1,
						MiB: 1024,
						GiB: 1024 * 1024
					};
					const value = parseFloat(fileSize);
					const unit = fileSize.match(/[A-Za-z]+/)[0];
					return value * units[unit];
				}

				function convertFileSize(sizeInKiB) {
					const units = ['KO', 'MO', 'GO'];
					let convertedSize = sizeInKiB;
					let unitIndex = 0;

					while (convertedSize >= 1024 && unitIndex < units.length - 1) {
						convertedSize /= 1024;
						unitIndex++;
					}

					const formattedSize = parseFloat(convertedSize.toFixed(2));
					const unit = units[unitIndex];

					return `${formattedSize} ${unit}`;
				}

				function saveNfoAsStorage() {
					var textToWrite = document.getElementById('output').value;
					var saveButton = document.getElementById('save-nfo');
					if (textToWrite == "Ou déposez directement les pistes de l'album ici") {
						alert('Aucun NFO généré');
					} else {
						// Enregistrement dans le localStorage
						var fileNameToSaveAs = originalFileName.replace(/\.[^.]+$/, '') + '.nfo';
						var currentDate = new Date();
						var temps = currentDate.getTime()
						var storageKey = 'NFO_' + temps;
						var storageKeyTitle = 'NFO_' + temps + '_title';
						localStorage.setItem(storageKey, textToWrite);
						localStorage.setItem(storageKeyTitle, fileNameToSaveAs);

						// Vérification du nombre d'éléments commençant par 'NFO_' dans le localStorage
						var nfoKeys = Object.keys(localStorage).filter(function(key) {
							return key.startsWith('NFO_');
						});
						if (nfoKeys.length > 100) {
							var oldestKey = null;
							var oldestTimestamp = Infinity;

							// Trouver la clé la plus ancienne
							for (var i = 0; i < nfoKeys.length; i++) {
								var key = nfoKeys[i];
								var timestamp = parseInt(key.substr(4));
								if (timestamp < oldestTimestamp) {
									oldestKey = key;
									oldestTimestamp = timestamp;
								}
							}

							// Supprimer la clé la plus ancienne
							if (oldestKey) {
								localStorage.removeItem(oldestKey);
							}
						}
					}
				}

				function saveNfoAsFile() {
					var textToWrite = document.getElementById('output').value;
					if (textToWrite == "Ou déposez directement les pistes de l'album ici") {
						alert('Aucun NFO généré');
					} else {
						var textFileAsBlob = new Blob([textToWrite], { type: 'text/plain' });
						var fileNameToSaveAs = originalFileName.replace(/\.[^.]+$/, '') + '.nfo';

						var downloadLink = document.createElement('a');
						downloadLink.download = fileNameToSaveAs;
						downloadLink.innerHTML = 'Lien du NFO';

						window.URL = window.URL || window.webkitURL;

						downloadLink.href = window.URL.createObjectURL(textFileAsBlob);
						downloadLink.onclick = destroyClickedElement;
						downloadLink.style.display = 'none';

						document.body.appendChild(downloadLink);

						downloadLink.click();
					}
				}

				function destroyClickedElement(event) {
					document.body.removeChild(event.target);
				}

				$('#save-nfo').click(function (e) {
					e.preventDefault();
					saveNfoAsStorage();
					var saveButton = $(this);
					saveButton.text('Enregistré !');
					setTimeout(function() {
						saveButton.text('Sauvegarder NFO');
					}, 1500);
				});

				$('#download-nfo').click(function (e) {
					e.preventDefault();
					saveNfoAsFile();
				});

			});

		</script>



</body></html>
